log '''\
--------------------------------------------------------------------
Load Jenkinsfile.default
'''

node {
    //def _config = pipelineConfig()
    def _config = env._config
    
    //Remove left indent
    //- http://mrhaki.blogspot.kr/2010/06/groovy-goodness-strip-leading-spaces_20.html
    log """\
      |--------------------------------------------------------------------
      |+ build scripted pipeline
      |+ pipeline config
      |${_config}"""
    
    // https://github.com/jenkinsci/script-security-plugin/blob/master/src/main/resources/org/jenkinsci/plugins/scriptsecurity/sandbox/whitelists/blacklist
    //println scm.properties
    
    _config = yaml.load(_config)
    _config.stage.each {
      stage(it) {
        echo """\
        |**Load:
        |${_config[it]}
        |**Dump:
        |${yaml.dump([(it): _config[it]])}
        """.stripMargin()
      }
    }
}
